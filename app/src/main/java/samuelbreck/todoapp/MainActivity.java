package samuelbreck.todoapp;import android.content.Intent;import android.os.Bundle;import android.support.v7.app.AppCompatActivity;import android.view.View;import android.widget.AdapterView;import android.widget.ArrayAdapter;import android.widget.EditText;import android.widget.ListView;import org.apache.commons.io.FileUtils;import java.io.File;import java.io.IOException;import java.util.ArrayList;public class MainActivity extends AppCompatActivity {    ArrayList<String> items;    ArrayAdapter<String> itemsAdapter;    ListView lvItems;    String edit = "";    private final int REQUEST_CODE = 20;    @Override    protected void onCreate(Bundle savedInstanceState) {        super.onCreate(savedInstanceState);        setContentView(R.layout.activity_main);        readItems();        lvItems = (ListView)findViewById(R.id.lvItems);        items = new ArrayList<>();        items.add("Task 1");        items.add("Task 2");        itemsAdapter = new ArrayAdapter<>(this, android.R.layout.simple_expandable_list_item_1, items);        lvItems.setAdapter(itemsAdapter);        setupListViewListener();    }    public void onAddItem(View v) {        EditText etNewItem = (EditText) findViewById(R.id.etNewItem);        String itemText = etNewItem.getText().toString();        itemsAdapter.add(itemText);        etNewItem.setText(""); // resets the etNewItem        writeItems();    }    public void setupListViewListener() {        lvItems.setOnItemClickListener(new AdapterView.OnItemClickListener() {            @Override            public void onItemClick(AdapterView<?> adapter, View item, int pos, long id) {                // creates the intent                Intent intention = new Intent(MainActivity.this, EditActivity.class);                intention.putExtra("pos", pos);                // launches the edit item screen                startActivityForResult(intention,REQUEST_CODE);            }        });        lvItems.setOnItemLongClickListener(new AdapterView.OnItemLongClickListener() {            @Override            public boolean onItemLongClick(AdapterView<?> adapter, View item, int pos, long id) {                items.remove(pos);                itemsAdapter.notifyDataSetChanged();                writeItems();                return true;            }        });    }    // ActivityOne.java, time to handle the result of the sub-activity    @Override    protected void onActivityResult(int requestCode, int resultCode, Intent data) {        // REQUEST_CODE is defined above        if (resultCode == RESULT_OK && requestCode == REQUEST_CODE) {            // Extract name value from result extras            edit = data.getExtras().getString("edits");            int pos = data.getExtras().getInt("pos", 0);            items.set(pos, edit);            // refreshes the adapter connected to the data set            itemsAdapter.notifyDataSetChanged();            writeItems();            // resets the edit            edit = "";        }    }    private void readItems () {        File filesDir = getFilesDir();        File todoFile = new File(filesDir, "todo.txt");        try {            items = new ArrayList<String>(FileUtils.readLines(todoFile));        }        catch (IOException e ) {            items = new ArrayList<String>();        }    }    private void writeItems() {        File filesDir = getFilesDir();        File todoFile = new File(filesDir, "todo.txt");        try {            FileUtils.writeLines(todoFile, items);        }        catch (IOException e ) {            e.printStackTrace();        }    }    @Override    public void onStart() {        super.onStart();    }    @Override    public void onStop() {        super.onStop();    }}